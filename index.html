<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Valentine's Day üíñ</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        body {
            margin: 0; padding: 0;
            font-family: 'Prompt', sans-serif;
            background: linear-gradient(rgba(255,255,255,0.3), rgba(255,255,255,0.3)), url('valentine.jpg') #fff5f7;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
            overflow: hidden;
        }

        /* --- ‡∏´‡∏ô‡πâ‡∏≤‡∏ã‡∏≠‡∏á‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢ --- */
        #envelopeContainer {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: 0.5s;
            z-index: 10;
        }

        .envelope {
            font-size: 100px;
            filter: drop-shadow(0 10px 15px rgba(0,0,0,0.1));
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        /* --- ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏Ç‡∏≤‡∏ß‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô --- */
        .card, .letter {
            background: #ffffff; 
            border-radius: 25px;
            box-shadow: 0 10px 25px rgba(255, 182, 193, 0.4);
            border: 2px solid #ffe4e8;
            position: relative;
            overflow: hidden;
        }

        .card {
            display: none; 
            padding: 45px 35px;
            max-width: 80%;
            animation: fadeIn 1s ease-out;
            z-index: 10;
        }

        .deco-in-paper {
            position: absolute;
            font-size: 18px;
            opacity: 0.8;
            pointer-events: none;
        }

        h1 { font-size: 28px; color: #ff8fa3; margin-bottom: 15px; position: relative; z-index: 2; }
        p { font-size: 17px; color: #555; line-height: 1.6; position: relative; z-index: 2; }

        button {
            padding: 10px 25px;
            font-size: 16px;
            border: none;
            border-radius: 25px;
            background: #ffb6c1;
            color: white;
            cursor: pointer;
            transition: 0.2s;
            margin: 8px;
            font-family: 'Prompt', sans-serif;
            position: relative;
            z-index: 2;
        }

        button:hover { background: #ff8fa3; }

        .letter {
            position: fixed;
            bottom: -100%;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 500px;
            padding: 30px;
            transition: 0.8s cubic-bezier(0.2, 1, 0.3, 1);
            text-align: center;
            z-index: 100;
        }

        .show-letter { bottom: 50% !important; transform: translate(-50%, 50%) !important; }

        .letter-content {
            max-height: 220px; 
            overflow-y: auto; 
            text-align: left; 
            padding: 15px; 
            background: rgba(255, 249, 250, 0.8); 
            border-radius: 15px;
            margin-bottom: 15px;
            border: 1px dashed #ffb6c1;
        }

        .item {
            position: absolute;
            bottom: -10vh;
            font-size: 30px;
            animation: float 8s linear infinite;
            z-index: 1;
            opacity: 0.7;
        }

        .cat-gif {
            width: 200px;
            height: auto;
            margin: 10px 0;
            border-radius: 20px;
            position: relative;
            z-index: 2;
        }

        /* ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
        #msgInput {
            width: 85%;
            padding: 12px;
            border: 2px solid #ffb6c1;
            border-radius: 15px;
            margin: 15px 0;
            font-family: 'Prompt', sans-serif;
            outline: none;
            font-size: 16px;
        }

        .loading {
            font-size: 14px;
            color: #ff8fa3;
            display: none;
            margin-top: 10px;
            font-weight: 600;
        }

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 0.7; }
            100% { transform: translateY(-110vh) rotate(360deg); opacity: 0; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>

<body>

    <div id="flowerZone">
        <div class="item" style="left:10%">üåπ</div>
        <div class="item" style="left:30%; animation-delay:2s;">üç´</div>
        <div class="item" style="left:50%; animation-delay:4s;">üíô</div>
        <div class="item" style="left:70%; animation-delay:1s;">ü§ç</div>
        <div class="item" style="left:90%; animation-delay:3s;">‚ù§Ô∏è</div>
    </div>

    <div id="envelopeContainer" onclick="openEnvelope()">
        <div class="envelope">‚úâÔ∏è</div>
        <p style="color: #0047AB; font-weight: 600; font-size: 18px;">
            ‡∏û‡∏µ‡πà‡∏´‡∏•‡∏¥‡∏ô‡∏°‡∏µ‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢ 1 ‡∏â‡∏ö‡∏±‡∏ö ‡∏Å‡∏î‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏™‡∏¥‡∏Ñ‡∏∞ üíå
        </p>
    </div>

    <div class="card" id="mainCard">
        <div class="deco-in-paper" style="top:10px; left:10px;">üåπ</div>
        <div class="deco-in-paper" style="top:15px; right:15px;">üíô</div>
        <div class="deco-in-paper" style="bottom:15px; left:15px;">üç´</div>
        <div class="deco-in-paper" style="bottom:10px; right:10px;">ü§ç</div>
        <h1>Happy Valentine's Day üíï</h1>
        <p>‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏Ç‡∏≠‡∏á‡πÅ‡∏°‡πá‡∏Å üíñ<br>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏ú‡∏°‡∏ô‡∏∞‡∏Ñ‡∏±‡∏ö<br>‡πÅ‡∏°‡πá‡∏Å‡∏£‡∏±‡∏Å‡∏û‡∏µ‡πà‡∏´‡∏•‡∏¥‡∏ô‡∏°‡∏≤‡∏Å‡∏ô‡∏∞ üíå</p>
        <button onclick="showLetter(1)">‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢ üíù</button>
    </div>

    <div class="letter" id="letter1">
        <div class="deco-in-paper" style="top:5px; left:15px;">üåπ</div>
        <div class="deco-in-paper" style="top:5px; right:15px;">‚ù§Ô∏è</div>
        <div class="deco-in-paper" style="bottom:10px; left:20px;">üíô</div>
        <div class="deco-in-paper" style="bottom:10px; right:20px;">üç´</div>
        <h2 style="color:#ff8fa3; margin-top:0; font-size: 22px;">üíå ‡∏ñ‡∏∂‡∏á‡∏û‡∏µ‡πà‡∏´‡∏•‡∏¥‡∏ô üíå</h2>
        <div class="letter-content">
            <p>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ß‡∏±‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡∏Ç‡∏≠‡∏á‡∏ú‡∏°‡∏î‡∏π‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô... ‡∏ú‡∏°‡∏£‡∏±‡∏Å‡∏û‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏ô‡∏∞‡∏Ñ‡∏±‡∏ö ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ú‡∏°‡∏ô‡∏∞‡∏Ñ‡∏±‡∏ö üíñ</p>
        </div>
        <button onclick="showLetter(2)">‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚û°Ô∏è</button>
    </div>

    <div class="letter" id="letter2">
        <div class="deco-in-paper" style="top:10px; left:10px;">üíô</div>
        <div class="deco-in-paper" style="top:10px; right:10px;">‚ù§Ô∏è</div>
        <div class="deco-in-paper" style="bottom:10px; left:10px;">ü§ç</div>
        <div class="deco-in-paper" style="bottom:10px; right:10px;">üåπ</div>
        <h2 style="color:#ff8fa3; margin-top:0; font-size: 22px;">üê± ‡∏£‡∏±‡∏ö‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡πÑ‡∏´‡∏°‡∏Ñ‡∏∞? üê±</h2>
        <img class="cat-gif" src="https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExcGltdzBmdGkwNHBkbXRwNzdldzNvMmplajNqNTdxa2t3NTUxZW9waSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/ycEx6eexqz4p7ZVrde/giphy.gif">
        
        <div id="choiceButtons">
            <button id="yesBtn" onclick="handleChoice('‡∏£‡∏±‡∏ö')">‡∏£‡∏±‡∏ö üíù</button>
            <button id="noBtn" onclick="handleChoice('‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö')">‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö üòã</button>
        </div>

        <div id="resultSection" style="display:none; margin-top:10px;">
            <h2 id="resultTitle" style="color:#ff8fa3; margin: 5px 0;">‡πÄ‡∏¢‡πâ! ‚ù§Ô∏è ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏∞‡∏Ñ‡∏±‡∏ö</h2>
            <p style="font-weight: 600; font-size: 16px; color: #555;">‡∏ù‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡πÅ‡∏°‡πá‡∏Å‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏ô‡∏∞:</p>
            <input type="text" id="msgInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ö‡∏≠‡∏Å‡∏≠‡∏∞‡πÑ‡∏£‡πÅ‡∏°‡πá‡∏Å‡∏´‡∏ô‡πà‡∏≠‡∏¢...">
            <br>
            <button id="sendBtn" onclick="sendMessage()">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° üíå</button>
            <p class="loading" id="loadText">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÑ‡∏õ‡∏´‡∏≤‡πÅ‡∏°‡πá‡∏Å...</p>
        </div>
    </div>

    <script>
        // ‡∏•‡∏¥‡∏á‡∏Å‡πå Google Apps Script ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxoKWwQ5ApDp_NuzcwQ2TVnRsXChI_Ik1pTbeMGDVqoukpJFS0GC3djonS1dV6os2Zx/exec"; 

        let noCount = 0;
        let yesScale = 1;

        function openEnvelope() {
            document.getElementById("envelopeContainer").style.opacity = "0";
            setTimeout(() => {
                document.getElementById("envelopeContainer").style.display = "none";
                document.getElementById("mainCard").style.display = "block";
            }, 500);
        }

        function showLetter(num) {
            document.getElementById("letter1").classList.remove("show-letter");
            document.getElementById("letter2").classList.remove("show-letter");
            document.getElementById("mainCard").style.display = "none";
            if(num === 1) document.getElementById("letter1").classList.add("show-letter");
            if(num === 2) document.getElementById("letter2").classList.add("show-letter");
        }

        function handleChoice(val) {
            const yesBtn = document.getElementById("yesBtn");
            const noBtn = document.getElementById("noBtn");
            if (val === '‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö') {
                noCount++;
                yesScale += 0.3; 
                yesBtn.style.transform = `scale(${yesScale})`;
                if (noCount >= 5) noBtn.style.display = "none";
                return;
            }
            if(val === '‡∏£‡∏±‡∏ö') {
                document.getElementById("flowerZone").style.display = "none";
                document.getElementById("choiceButtons").style.display = "none";
                document.getElementById("resultSection").style.display = "block";
            }
        }

        function sendMessage() {
            const msg = document.getElementById("msgInput").value;
            const btn = document.getElementById("sendBtn");
            const loadText = document.getElementById("loadText");

            if(!msg) { alert("‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ö‡∏≠‡∏Å‡πÅ‡∏°‡πá‡∏Å‡∏™‡∏±‡∏Å‡∏ô‡∏¥‡∏î‡∏ô‡πâ‡∏≤‡∏≤ üòä"); return; }

            btn.disabled = true;
            loadText.style.display = "block";

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏á‡πÑ‡∏õ Google Sheets
            const formData = new FormData();
            formData.append("message", msg);

            fetch(SCRIPT_URL, {
                method: 'POST',
                body: formData
            })
            .then(res => {
                loadText.innerText = "‡∏™‡πà‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! ‡∏£‡∏±‡∏Å‡∏û‡∏µ‡πà‡∏´‡∏•‡∏¥‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏±‡∏ö üíñ";
                document.getElementById("msgInput").value = "";
                setTimeout(() => { closeLetter(); }, 2500);
            })
            .catch(err => {
                // ‡∏Å‡∏£‡∏ì‡∏µ no-cors ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏î‡πâ‡∏á‡∏°‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÅ‡∏ï‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥
                loadText.innerText = "‡∏™‡πà‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! ‡∏£‡∏±‡∏Å‡∏û‡∏µ‡πà‡∏´‡∏•‡∏¥‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏±‡∏ö üíñ";
                setTimeout(() => { closeLetter(); }, 2500);
            });
        }

        function closeLetter() {
            document.getElementById("letter1").classList.remove("show-letter");
            document.getElementById("letter2").classList.remove("show-letter");
            document.getElementById("mainCard").style.display = "block";
            document.getElementById("resultSection").style.display = "none";
            document.getElementById("choiceButtons").style.display = "block";
            document.getElementById("loadText").style.display = "none";
            document.getElementById("loadText").innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÑ‡∏õ‡∏´‡∏≤‡πÅ‡∏°‡πá‡∏Å...";
            document.getElementById("sendBtn").disabled = false;
            document.getElementById("flowerZone").style.display = "block";
        }
    </script>
</body>
</html>
